{
  "always_filter_main_dttm": false,
  "cache_timeout": null,
  "column_formats": {},
  "column_types": [
    0,
    1,
    2
  ],
  "columns": [
    {
      "advanced_data_type": null,
      "certification_details": null,
      "certified_by": null,
      "column_name": "ema_38",
      "description": null,
      "expression": null,
      "filterable": true,
      "groupby": true,
      "id": 28,
      "is_certified": false,
      "is_dttm": false,
      "python_date_format": null,
      "type": "Float64",
      "type_generic": 0,
      "verbose_name": null,
      "warning_markdown": null
    },
    {
      "advanced_data_type": null,
      "certification_details": null,
      "certified_by": null,
      "column_name": "ema_100",
      "description": null,
      "expression": null,
      "filterable": true,
      "groupby": true,
      "id": 29,
      "is_certified": false,
      "is_dttm": false,
      "python_date_format": null,
      "type": "Float64",
      "type_generic": 0,
      "verbose_name": null,
      "warning_markdown": null
    },
    {
      "advanced_data_type": null,
      "certification_details": null,
      "certified_by": null,
      "column_name": "ema_100_if_bearish",
      "description": null,
      "expression": null,
      "filterable": true,
      "groupby": true,
      "id": 37,
      "is_certified": false,
      "is_dttm": false,
      "python_date_format": null,
      "type": "Nullable(Float64)",
      "type_generic": null,
      "verbose_name": null,
      "warning_markdown": null
    },
    {
      "advanced_data_type": null,
      "certification_details": null,
      "certified_by": null,
      "column_name": "id",
      "description": null,
      "expression": null,
      "filterable": true,
      "groupby": true,
      "id": 38,
      "is_certified": false,
      "is_dttm": false,
      "python_date_format": null,
      "type": "String",
      "type_generic": 1,
      "verbose_name": null,
      "warning_markdown": null
    },
    {
      "advanced_data_type": null,
      "certification_details": null,
      "certified_by": null,
      "column_name": "ema_38_if_bullish",
      "description": null,
      "expression": null,
      "filterable": true,
      "groupby": true,
      "id": 33,
      "is_certified": false,
      "is_dttm": false,
      "python_date_format": null,
      "type": "Nullable(Float64)",
      "type_generic": null,
      "verbose_name": null,
      "warning_markdown": null
    },
    {
      "advanced_data_type": null,
      "certification_details": null,
      "certified_by": null,
      "column_name": "window_start",
      "description": null,
      "expression": null,
      "filterable": true,
      "groupby": true,
      "id": 40,
      "is_certified": false,
      "is_dttm": true,
      "python_date_format": null,
      "type": "DateTime",
      "type_generic": 2,
      "verbose_name": null,
      "warning_markdown": null
    }
  ],
  "currency_formats": {},
  "database": {
    "allows_cost_estimate": false,
    "allows_subquery": true,
    "allows_virtual_table_explore": true,
    "backend": "clickhousedb",
    "disable_data_preview": false,
    "explore_database_id": 1,
    "id": 1,
    "name": "default"
  },
  "datasource_name": "Bearish/Bullish (Q2) V2",
  "default_endpoint": null,
  "edit_url": "/tablemodelview/edit/5",
  "fetch_values_predicate": null,
  "filter_select": true,
  "filter_select_enabled": true,
  "granularity_sqla": [
    [
      "window_start",
      "window_start"
    ]
  ],
  "health_check_message": null,
  "id": 5,
  "is_sqllab_view": true,
  "main_dttm_col": null,
  "metrics": [],
  "name": "default.Bearish/Bullish (Q2) V2",
  "normalize_columns": false,
  "offset": 0,
  "order_by_choices": [
    [
      "[\"bearish\", true]",
      "bearish [asc]"
    ],
    [
      "[\"bearish\", false]",
      "bearish [desc]"
    ],
    [
      "[\"bullish\", true]",
      "bullish [asc]"
    ],
    [
      "[\"bullish\", false]",
      "bullish [desc]"
    ],
    [
      "[\"ema_100\", true]",
      "ema_100 [asc]"
    ],
    [
      "[\"ema_100\", false]",
      "ema_100 [desc]"
    ],
    [
      "[\"ema_100_if_bearish\", true]",
      "ema_100_if_bearish [asc]"
    ],
    [
      "[\"ema_100_if_bearish\", false]",
      "ema_100_if_bearish [desc]"
    ],
    [
      "[\"ema_38\", true]",
      "ema_38 [asc]"
    ],
    [
      "[\"ema_38\", false]",
      "ema_38 [desc]"
    ],
    [
      "[\"ema_38_if_bullish\", true]",
      "ema_38_if_bullish [asc]"
    ],
    [
      "[\"ema_38_if_bullish\", false]",
      "ema_38_if_bullish [desc]"
    ],
    [
      "[\"ema_38_larger_than_100\", true]",
      "ema_38_larger_than_100 [asc]"
    ],
    [
      "[\"ema_38_larger_than_100\", false]",
      "ema_38_larger_than_100 [desc]"
    ],
    [
      "[\"ema_38_less_than_100\", true]",
      "ema_38_less_than_100 [asc]"
    ],
    [
      "[\"ema_38_less_than_100\", false]",
      "ema_38_less_than_100 [desc]"
    ],
    [
      "[\"id\", true]",
      "id [asc]"
    ],
    [
      "[\"id\", false]",
      "id [desc]"
    ],
    [
      "[\"previous_ema_38_larger_than_100\", true]",
      "previous_ema_38_larger_than_100 [asc]"
    ],
    [
      "[\"previous_ema_38_larger_than_100\", false]",
      "previous_ema_38_larger_than_100 [desc]"
    ],
    [
      "[\"previous_ema_38_less_than_100\", true]",
      "previous_ema_38_less_than_100 [asc]"
    ],
    [
      "[\"previous_ema_38_less_than_100\", false]",
      "previous_ema_38_less_than_100 [desc]"
    ],
    [
      "[\"t\", true]",
      "t [asc]"
    ],
    [
      "[\"t\", false]",
      "t [desc]"
    ],
    [
      "[\"window_start\", true]",
      "window_start [asc]"
    ],
    [
      "[\"window_start\", false]",
      "window_start [desc]"
    ]
  ],
  "owners": [
    {
      "first_name": "Superset",
      "id": 1,
      "last_name": "Admin",
      "username": "admin"
    }
  ],
  "params": null,
  "perm": "[default].[Bearish/Bullish (Q2) V2](id:5)",
  "schema": "default",
  "select_star": "SELECT *\nFROM `default`.`Bearish/Bullish (Q2) V2`\nLIMIT 100",
  "sql": "WITH\n    toDateTime('2021-11-08 00:00:00') AS start_time,\n    2/(1+38) AS alpha_38,\n    -ln(2)/ln(1-alpha_38) AS half_time_38,\n    2/(1+100) AS alpha_100,\n    -ln(2)/ln(1-alpha_100) AS half_time_100,\n    trading_data AS (\n    \tSELECT\n\t        toStartOfFiveMinutes(trading_time) AS window_start,\n\t        last_value(last) AS value,\n\t\t\t\t\trow_number() OVER (PARTITION BY id ORDER BY window_start ASC) AS t,\n\t        id\n\t    FROM trades\n\t    WHERE trading_time >= start_time\n\t\t\t\t{% if filter_values('id')|length %}\n\t\t\t\t\tAND id IN {{ filter_values('id')|where_in }}\n\t\t\t\t{% endif %}\n\t\t\t\tAND NOT (last = 0 AND toHour(trading_time) = 2 AND toMinute(trading_time) = 0 AND toSecond(trading_time) = 0)\n\t    GROUP BY window_start, id\n\t    ORDER BY window_start ASC\n    )\nSELECT\n\tid,\n\tt,\n\twindow_start,\n\tema_38,\n\tema_100,\n\n\tema_38 > ema_100 AS ema_38_larger_than_100,\n\tlagInFrame(ema_38_larger_than_100, 1, FALSE) OVER (PARTITION BY id ORDER BY t ASC) AS previous_ema_38_larger_than_100,\n\tema_38_larger_than_100 AND NOT previous_ema_38_larger_than_100 AS bullish,\n\tCASE WHEN bullish THEN ema_38 ELSE NULL END AS ema_38_if_bullish,\n\t\n\t\n    ema_38 < ema_100 AS ema_38_less_than_100,\n\tlagInFrame(ema_38_less_than_100, 1, TRUE) OVER (PARTITION BY id ORDER BY t ASC) AS previous_ema_38_less_than_100,\n\tema_38_less_than_100 AND NOT previous_ema_38_less_than_100 AS bearish,\n\tCASE WHEN bearish THEN ema_100 ELSE NULL END AS ema_100_if_bearish\nFROM (\n\tSELECT\n\t\tid,\n\t\twindow_start,\n\t\tt,\n\t    exponentialMovingAverage(half_time_38)(value, t) OVER (PARTITION BY id ORDER BY t ASC Rows BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS ema_38,\n\t    exponentialMovingAverage(half_time_100)(value, t) OVER (PARTITION BY id ORDER BY t ASC Rows BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS ema_100\n\tFROM trading_data\n);",
  "table_name": "Bearish/Bullish (Q2) V2",
  "template_params": null,
  "time_grain_sqla": [
    [
      "PT1M",
      "Minute"
    ],
    [
      "PT5M",
      "5 minute"
    ],
    [
      "PT10M",
      "10 minute"
    ],
    [
      "PT15M",
      "15 minute"
    ],
    [
      "PT30M",
      "30 minute"
    ],
    [
      "PT1H",
      "Hour"
    ],
    [
      "P1D",
      "Day"
    ],
    [
      "P1W",
      "Week"
    ],
    [
      "P1M",
      "Month"
    ],
    [
      "P3M",
      "Quarter"
    ],
    [
      "P1Y",
      "Year"
    ]
  ],
  "type": "table",
  "uid": "5__table",
  "verbose_map": {
    "__timestamp": "Time",
    "ema_100": "ema_100",
    "ema_100_if_bearish": "ema_100_if_bearish",
    "ema_38": "ema_38",
    "ema_38_if_bullish": "ema_38_if_bullish",
    "id": "id",
    "window_start": "window_start"
  }
}